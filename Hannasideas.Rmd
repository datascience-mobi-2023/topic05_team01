---
title: "Hanna_BioInfo"
output: html_document
date: "2023-05-14"
---

# Hanna's random ideas

**Plotting a drug response against a gene that is overexpressed in prism.exp_gastric:**

```{r}
pheatmap(r.prism.exp_g)
#heatmap shows that there are not many values bigger than ten-> very overexpressed genes in certain cellines -> these genes i wanna extract from the dataframe into a new one
# Specify the threshold
tthreshold <- 10

# Extract columns that include values lower than the threshold
overe.genes <- r.prism.exp_g[, apply(r.prism.exp_g, 2, function(col) any(col > tthreshold))]

# Print the selected columns
print(overe.genes)
```

Reduced dataframe:

```{r}
pheatmap(overe.genes)
```

```{r}
# Calculate the mean of each column
col_Means <- colMeans(selected_drugs)

# Set a threshold for column mean
mean_threshold <- -6.5

# Select columns with mean greater than the threshold
selected_columns <- selected_drugs[, col_means < mean_threshold]
pheatmap(selected_columns,  cellwidth = 10, cellheight = 5)
```

```{r}
dim(selected_columns)
dim(overe.genes)
print(overe.genes)
print(selected_columns)
```

Creating new dataframe of selected_columns reducing for the cell line that is more in overe.genes:

```{r}
og.v<-rownames(overe.genes)
selected_columns <- selected_columns[rownames(selected_columns) %in% og.v, ]
View (selected_columns)
```

```{r}
pheatmap(r.prism.cnv_g)
```

```{r}
plot(prism_gastric$`BRD-A00077618-236-07-6::0.00061034::HTS002`, prism.cnv_gastric$DDX11L1, type = "p", pch = 16, col = "blue",
     xlab = "BRD-A00077618-236-07-6::0.00061034::HTS002", ylab = "DDX11L1", main = "Scatter Plot")
cor(prism_gastric$`BRD-A00077618-236-07-6::0.00061034::HTS002`,prism.cnv_gastric$DDX11L1, method = 'pearson')
```

```{r}
# Select the row you want to create a histogram for (e.g., row 3)
prism_g_1 <- prism_gastric_cleaned_treatments[1, ]

# Convert the row values to a numeric vector
prism_g_1 <- as.numeric(prism_g_1)

# Create a histogram of the row values
hist(prism_g_1)
```

```{r}

# Specify the threshold
threshold <- -7

# Extract columns that include values lower than the threshold
selected_drugs <- prism_gastric_cleaned_treatments[, apply(prism_gastric_cleaned_treatments, 2, function(col) any(col < threshold))]

# Print the selected columns
print(selected_drugs)
```

```{r}
class(selected_drugs)
heatmap_sd <- pheatmap(selected_drugs,cellwidth = 4, cellheight = 4, show_rownames = FALSE, show_colnames = FALSE)
```

```{r}
# Perform k-means clustering
kmeans_res <- kmeans(prism_gastric_cleaned_treatments, centers = 2)

# Extract cluster assignments
cluster_assignments <- kmeans_res$cluster

# Select the desired cluster
desired_cluster <- 2  # Adjust as needed

# Extract columns belonging to the desired cluster
clustered_columns <- prism_gastric_cleaned_treatments[, cluster_assignments == desired_cluster]

# Create a new dataframe with clustered columns
new_dataframe <- as.data.frame(clustered_columns)

```

```{r}
# Perform hierarchical clustering
hc <- hclust(dist(prism_gastric_cleaned_treatments))  # df is your dataframe

# Set the desired number of clusters
num_clusters <- 5  # Adjust as needed

# Cut the tree to obtain cluster assignments
clusters <- cutree(hc, k = num_clusters)

# Select the desired cluster
desired_cluster <- 1  # Adjust as needed

# Extract columns belonging to the desired cluster
clustered_columns <- prism_gastric_cleaned_treatments[, clusters == desired_cluster]

# Create a new dataframe with clustered columns
new_dataframe2 <- data.frame(clustered_columns)
```

```{r}
heatmap <- pheatmap(clustered_columns, cellwidth = 2, cellheight = 2)
```

```{r}
# Calculate the mean of each row
col_means <- colMeans(selected_drugs)

# Print the row means
print(col_means)
hist(col_means)
```

```{r}
# Calculate the mean of each column
col_Means <- colMeans(selected_drugs)

# Set a threshold for column mean
mean_threshold <- -6.5

# Select columns with mean greater than the threshold
selected_columns <- selected_drugs[, col_means < mean_threshold]
pheatmap(selected_columns)
```

```{r}
boxplot(selected_columns, pch=22)
```

```{r}
selected_drugsv <- colnames(selected_drugs)

View(selected_drugsv)

prism_drugs <- prism[ ,colnames(prism) %in% selected_drugsv]
View (prism_drugs)
```

# Distribution of prism_gastric

```{r}
#Apply hist() to each column using lapply() 
lapply(prism_gastric_cleaned_treatments, hist, breaks = 20, col = "blue", main = "Distribution Diagram", xlab = "Values")
```

```{r}
# Perform t-test
t_test_result <- t.test(selected_drugs$BRD.A28970875.300.04.9..10..HTS002, selected_drugs$BRD.A54927599.001.16.9..10..HTS002)

# View the t-test result
print(t_test_result)

```

```{r}
pheatmap(r.prism.exp_g,cellwidth = 2, cellheight = 2, show_rownames = FALSE, show_colnames = FALSE)
```

```{r}
pheatmap(r.prism.exp_g,show_colnames = FALSE)
```

```{r}
density_est<- density(r.prism.achilles_g)

plot(density_est, main="Density plot of prism.achilles ")
```

```{r}
r.prism.achilles_g<- (sapply(r.prism.achilles_g, as.numeric))
is.numeric(r.prism.achilles_g)
```

General overview of the data

```{r}
prism_cleaned_drugs<- prism[,colSums(is.na(prism))==0]
prism_cleaned_drugs<- (sapply(prism, as.numeric))
is.numeric(prism_cleaned_drugs)
```

```{r}
hist(prism_cleaned_drugs)

```

**PCA von prism.exp mit allen celllines:**

```{r}
prism_genes<- prism.snv[grepl("True", prism.snv$isDeleterious),]
View(prism_genes)
#reducing the genes to just the genes that are damaging to the gastric cancer cells
r.prism.exp <- prism.exp[ ,colnames(prism.exp) %in% genes.snv_v]
```

```{r}
pheatmap(r.prism.exp)
```

Step 1: Create 5 vectors for the 5 different cancer cell lines

dataframe of breast cancer cell lines:

```{r}
breast.cancer.celllines <- subset(prism.cl, lineage == "breast")

View(breast.cancer.celllines)
```

Dataframe of gastric cancer cell lines:

```{r}
gastric.cancer.celllines <- subset(prism.cl, lineage == "gastric")

View(gastric.cancer.celllines)
```

Dataframe of kidney cancer cell lines:

```{r}
kidney.cancer.celllines <- subset(prism.cl, lineage == "kidney")

View(kidney.cancer.celllines)
```

Dataframe of liver cancer cell lines:

```{r}
liver.cancer.celllines <- subset(prism.cl, lineage == "liver")

View(liver.cancer.celllines)
```

Dataframe of bone cancer cell lines:

```{r}
bone.cancer.celllines <- subset(prism.cl, lineage == "bone")

View(bone.cancer.celllines)
```

**Extract these IDs from prism.exp**

```{r}
gastric.cancer.celllines.v <- gastric.cancer.celllines $DepMap_ID
breast.cancer.celllines.v <- breast.cancer.celllines $DepMap_ID
kidney.cancer.celllines.v <- kidney.cancer.celllines $DepMap_ID
bone.cancer.celllines.v <- bone.cancer.celllines $DepMap_ID
liver.cancer.celllines.v <- liver.cancer.celllines $DepMap_ID
cancer.celllines.v <- c(liver.cancer.celllines.v,bone.cancer.celllines.v,kidney.cancer.celllines.v,  breast.cancer.celllines.v,gastric.cancer.celllines.v)


View(gastric.cancer.celllines.v)
```

```{r}
prism.exp_celllines <- prism.exp[rownames(prism.exp) %in% cancer.celllines.v, ]
View (prism.exp_celllines)
```

Step 2 NA values:

```{r}
typeof(prism.exp_celllines)

prism.exp_celllines_numeric <- (

  sapply(prism.exp_celllines, as.numeric)

)

is.numeric(prism.exp_celllines_numeric)

prism.exp_celllines_numeric[is.na(prism.exp_celllines_numeric)] <-median(prism.exp_celllines_numeric,na.rm =TRUE)

sum(is.na(prism.exp_celllines_numeric))

View(prism.exp_celllines_numeric)

```

Remove columns with zero from the dataframe:

```{r}
# Remove columns with 0 values
prism.exp_celllines_numeric <- prism.exp_celllines_numeric[, colSums(prism.exp_celllines_numeric== 0) == 0]

# Print the filtered dataframe
print(prism.exp_celllines_numeric)
```

**PCA of this reduced data frame:**

```{r}
standardized_data.pe <- scale(prism.exp_celllines_numeric)

pca_result.pe <- prcomp(standardized_data.pe, scale. = FALSE)

View(pca_result.pe)

pcs <- pca_result.pe$x

variance_explained.pe <- pca_result.pe$sdev^2 / sum(pca_result.pe$sdev^2)

loadings.pe <- pca_result.pe$rotation

scree_plot <- plot(1:length(variance_explained.pe), variance_explained.pe, type = "b",

                    xlab = "Principal Component", ylab = "Variance Explained")


```

```{r}
# Extract the principal components
pc1 <- pca_result.pe$x[, 1] # First principal component
pc2 <- pca_result.pe$x[, 2] # Second principal component
pc_to_color <- as.numeric(pca_result.pe$x[, 3])  # Convert to numeric
# Create the scatter plot
plot(pc1, pc2, xlab = "PC1", ylab = "PC2",main = "PCA Scatter Plot", )

adjusted_color <- pc_to_color - min(pc_to_color) + 1

# Create the scatter plot with color-coded third principal component
plot(pc1, pc2, xlab = "PC1", ylab = "PC2", main = "PCA Scatter Plot",
     col = adjusted_color, pch = 16)

# Add a color legend
legend("topright", legend = "PC3", col = unique(pc_to_color), pch = 16)
```

```{r}


# Extract the principal components
pcs <- pca_result.pe$x  # All principal components

# Create the scatter plot with color-coded principal components
plot(pcs[, 1], pcs[, 2], xlab = "PC1", ylab = "PC2", main = "PCA Scatter Plot",
     col = 1:length(pcs), pch = 16)

# Create a legend with colors for each principal component
legend("topright", legend = paste0("PC", 1:ncol(pcs)),
       col = 1:length(pcs), pch = 16)
```

```{r}
# Extract the principal components
pc4 <- pca_result.pe$x[, 4] # First principal component
pc7 <- pca_result.pe$x[, 7] # Second principal component
pc_to_color <- as.numeric(pca_result.pe$x[, 3])  # Convert to numeric
# Create the scatter plot
plot(pc1, pc2, xlab = "PC4", ylab = "PC7",main = "PCA Scatter Plot", )

adjusted_color <- pc_to_color - min(pc_to_color) + 1

# Create the scatter plot with color-coded third principal component
plot(pc1, pc2, xlab = "PC4", ylab = "PC7", main = "PCA Scatter Plot",
     col = adjusted_color, pch = 16)

# Add a color legend
legend("topright", legend = "PC3", col = unique(pc_to_color), pch = 16)
```

**Calculating the variance of the rows in Prism.exp to find the genes that show the highest variance in the five cancer types and are the genes that distinguish the cancer types:**

```{r}
# Transpose the dataframe
transposed_prism.exp_celllines <- t(prism.exp_celllines)
```

```{r}

# Calculate the variance of each row

gene.exp_variances <- apply(transposed_prism.exp_celllines, MARGIN = 1, var)
```

```{r}
#plotting the variances to define a logical treshold for selecting drugs
hist(gene.exp_variances)
```

```{r}
threshold <- 3
selected_genes_var <- transposed_prism.exp_celllines[gene.exp_variances > threshold, ]
```

```{r}
print(selected_genes_var)
```

```{r}
prism.exp.var<-t(selected_genes_var)
```

PCA von Prism.exp:

```{r}

pca_result_prism.exp.var <- prcomp(prism.exp.var)
pca_values <- pca_result_prism.exp.var$x # Principal component scores (transformed data)
pca_variances <- pca_result_prism.exp.var$sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <- pca_result_prism.exp.var$rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c("Bone cancer"=bone.cancer.celllines.group, "Kidney cancer"=kidney.cancer.celllines.group, "Liver cancer"=liver.cancer.celllines.group, "Gastric cancer"=gastric.cancer.celllines.group,"Breast cancer"= breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")

```

```{r}
pca_result_genes_var <- prcomp(selected_genes_var)
pca_values <- pca_result_genes_var$x # Principal component scores (transformed data)
pca_variances <- pca_result_genes_var$sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <- pca_result_genes_var$rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c(bone.cancer.celllines.group, kidney.cancer.celllines.group, liver.cancer.celllines.group, gastric.cancer.celllines.group, breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")
```

**Create new dataframes of prism based of the treatments original indication:**

Creating dataframe of prism with treatment of oncology and with treat not of oncology

```{r}
condition1 <- prism.treat$disease.area ==  'oncology'
condition2 <- prism.treat$disease.area !=  'oncology'
```

```{r}
selected_treat_onc<- rownames(prism.treat)[condition1]
selected_treat_nonc<- rownames(prism.treat)[condition2]
selected_treat_onc <- na.omit(selected_treat_onc)
selected_treat_nonc<- na.omit(selected_treat_nonc)
```

```{r}
prism_onc <- prism_celllines[, selected_treat_onc,drop = FALSE] 
prism_nonc <- prism_celllines[, selected_treat_nonc,drop = FALSE]
```

```{r}
# Replace NA values with zero in the entire dataframe
prism_onc[is.na(prism_onc)] <- 0
# Replace NA values with zero in the entire dataframe
prism_nonc[is.na(prism_nonc)] <- 0
pheatmap(prism_onc)
```

```{r}
pheatmap(prism_nonc,ColCol = NA)
```

**Trying to extract treatments froms prism.treat that have already an indication related to gastric affected diseases:**

```{r}
gastric_treat <- subset(prism.treat, grepl("gastroenterology", disease.area))
selected_gastric_treat<- rownames(gastric_treat)

selected_gastric_treat<- na.omit(selected_gastric_treat)
prism_gastrictreat <- prism_celllines[, selected_gastric_treat,drop = FALSE]
```

```{r}
# Replace NA values with zero in the entire dataframe
prism_gastrictreat[is.na(prism_gastrictreat)] <- 0

pheatmap(prism_gastrictreat)
```

**Reducing the dataframe prism.exp to just the genes that show high variance within a cancertype to see if the clustering based on PCA differs :**

First Step:

Create dataframes with just the cellines from one of the five cancer types:

```{r}
#Gastric cancer Dataframe of Prism.exp
G.prism.exp<-prism.exp_celllines[rownames(prism.exp_celllines) %in% gastric.cancer.celllines.v, ]
#Kidney cancer Dataframe of Prism.exp
K.prism.exp<-prism.exp_celllines[rownames(prism.exp_celllines) %in% kidney.cancer.celllines.v, ]
#Bone cancer Dataframe of Prism.exp
B.prism.exp<-prism.exp_celllines[rownames(prism.exp_celllines) %in% bone.cancer.celllines.v, ]
#Breast cancer Dataframe of Prism.exp
Br.prism.exp<-prism.exp_celllines[rownames(prism.exp_celllines) %in% breast.cancer.celllines.v, ]
#Liver cancer Dataframe of Prism.exp
L.prism.exp<-prism.exp_celllines[rownames(prism.exp_celllines) %in% liver.cancer.celllines.v, ]
```

Second step:

Transpose those dataframes to calculate the variance of each row so from the gene expression of one gene :

```{r}
# Transpose the dataframes
t.G.prism.exp <- t(G.prism.exp)
t.K.prism.exp<- t(K.prism.exp)
t.B.prism.exp<- t(B.prism.exp)
t.Br.prism.exp<-t(Br.prism.exp)
t.L.prism.exp<-t(L.prism.exp)
```

```{r}
# Calculate the variance of each row of the dataframes cancertypes

G.gene.exp_variances <- apply(t.G.prism.exp, MARGIN = 1, var)
K.gene.exp_variances <- apply(t.K.prism.exp, MARGIN = 1, var)
B.gene.exp_variances <- apply(t.B.prism.exp, MARGIN = 1, var)
Br.gene.exp_variances <- apply(t.Br.prism.exp, MARGIN = 1, var)
L.gene.exp_variances <- apply(t.L.prism.exp, MARGIN = 1, var)
```

```{r}
#plotting the variances to define a logical treshold for selecting drugs
hist(G.gene.exp_variances)
hist(K.gene.exp_variances)
hist(L.gene.exp_variances)
hist(B.gene.exp_variances)
hist(Br.gene.exp_variances)
```

Tresholds:

Gatsric Cancer: 3

Kidney Cancer: 3

Liver Cancer: 4

Bone Cancer : 3

Breast Cancer 3

```{r}
threshold <- 7
G.selected_genes_var <- t.G.prism.exp[G.gene.exp_variances > threshold, ]
threshold <- 7
K.selected_genes_var <- t.K.prism.exp[K.gene.exp_variances > threshold, ]
threshold2 <- 8
L.selected_genes_var <- t.L.prism.exp[L.gene.exp_variances > threshold2, ]
threshold <- 7
B.selected_genes_var <- t.B.prism.exp[B.gene.exp_variances > threshold, ]
threshold <- 7
Br.selected_genes_var <- t.Br.prism.exp[Br.gene.exp_variances > threshold, ]
```

```{r}
G.prism.exp.var<-t(G.selected_genes_var)
K.prism.exp.var<-t(K.selected_genes_var)
L.prism.exp.var<-t(L.selected_genes_var)
B.prism.exp.var<-t(B.selected_genes_var)
Br.prism.exp.var<-t(Br.selected_genes_var)
```

Step 3: Creating a new dataframe of prism.exp with all genes that are left in the dataframes reduced to the genes showing high variance within a cancer type:

```{r}
G.column_names <- colnames(G.prism.exp.var)
K.column_names <- colnames(K.prism.exp.var)
L.column_names <- colnames(L.prism.exp.var)
B.column_names <- colnames(B.prism.exp.var)
Br.column_names <- colnames(Br.prism.exp.var)

```

```{r}
genes_variance.V <- c(G.column_names,K.column_names,L.column_names,B.column_names,Br.column_names)
```

```{r}
prism.exp_geneshv <- prism.exp_celllines[,colnames( prism.exp_celllines) %in% genes_variance.V ]

```

Step 4: Creating PCA

```{r}
pca_result_prism.exp_geneshv <- prcomp(prism.exp_geneshv)
pca_values <- pca_result_prism.exp_geneshv $x # Principal component scores (transformed data)
pca_variances <- pca_result_prism.exp_geneshv $sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <- pca_result_prism.exp_geneshv $rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c("Bone cancer"=bone.cancer.celllines.group, "Kidney cancer"=kidney.cancer.celllines.group, "Liver cancer"=liver.cancer.celllines.group, "Gastric cancer"=gastric.cancer.celllines.group,"Breast cancer"= breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")
```

**Applying PCA on the oncological and non-oncological dataframes:**

```{r}
pca_result_prism_onc <- prcomp(prism_onc)
pca_values <- pca_result_prism_onc$x # Principal component scores (transformed data)
pca_variances <- pca_result_prism_onc$sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <-  pca_result_prism_onc$rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c("Bone cancer"=bone.cancer.celllines.group, "Kidney cancer"=kidney.cancer.celllines.group, "Liver cancer"=liver.cancer.celllines.group, "Gastric cancer"=gastric.cancer.celllines.group,"Breast cancer"= breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")
```

```{r}
pca_result_prism_nonc <- prcomp(prism_nonc)
pca_values <- pca_result_prism_nonc$x # Principal component scores (transformed data)
pca_variances <- pca_result_prism_nonc$sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <-  pca_result_prism_nonc$rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c("Bone cancer"=bone.cancer.celllines.group, "Kidney cancer"=kidney.cancer.celllines.group, "Liver cancer"=liver.cancer.celllines.group, "Gastric cancer"=gastric.cancer.celllines.group,"Breast cancer"= breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")
```

```{r}
prism_gastrictreat
pca_result_prism_gastrictreat <- prcomp(prism_gastrictreat)
pca_values <- pca_result_prism_gastrictreat$x # Principal component scores (transformed data)
pca_variances <- pca_result_prism_gastrictreat$sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <-  pca_result_prism_gastrictreat$rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c("Bone cancer"=bone.cancer.celllines.group, "Kidney cancer"=kidney.cancer.celllines.group, "Liver cancer"=liver.cancer.celllines.group, "Gastric cancer"=gastric.cancer.celllines.group,"Breast cancer"= breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")
```

Transposing the dataframes to do pca with treatments as dots:

```{r}
t.prism_onc<-t(prism_onc)
t.prism_nonc<-t(prism_nonc)
t.prism_gastrictreat<-t(prism_gastrictreat)
```

```{r}
prism_gastrictreat
pca_result_t.prism_onc <- prcomp(t.prism_onc)
pca_values <- pca_result_t.prism_onc$x # Principal component scores (transformed data)
pca_variances <- pca_result_t.prism_onc$sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <-  pca_result_t.prism_onc$rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c("Bone cancer"=bone.cancer.celllines.group, "Kidney cancer"=kidney.cancer.celllines.group, "Liver cancer"=liver.cancer.celllines.group, "Gastric cancer"=gastric.cancer.celllines.group,"Breast cancer"= breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")
```

```{r}
prism_gastrictreat
pca_result_t.prism_nonc <- prcomp(t.prism_nonc)
pca_values <- pca_result_t.prism_nonc$x # Principal component scores (transformed data)
pca_variances <-pca_result_t.prism_nonc$sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <-  pca_result_t.prism_nonc$rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c("Bone cancer"=bone.cancer.celllines.group, "Kidney cancer"=kidney.cancer.celllines.group, "Liver cancer"=liver.cancer.celllines.group, "Gastric cancer"=gastric.cancer.celllines.group,"Breast cancer"= breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")
```

```{r}
prism_gastrictreat
pca_result_t.prism_gastrictreat <- prcomp(t.prism_gastrictreat)
pca_values <- pca_result_t.prism_gastrictreat$x # Principal component scores (transformed data)
pca_variances <- pca_result_t.prism_gastrictreat$sdev^2  # Variance explained by each principal component
pca_proportions <- pca_variances / sum(pca_variances)  # Proportion of variance explained by each principal component
pca_loadings <-  pca_result_t.prism_gastrictreat$rotation  # Loadings (coefficients) of each variable on each principal component
 plot(1:length(pca_variances), pca_variances, type = "b", xlab = "Principal Component", ylab = "Variance Explained",
     main = "Scree Plot")
plot(pca_values[, 1], pca_values[, 2], xlab = "PC1", ylab = "PC2")


###
pca_data <- data.frame(PC1 = pca_values[, 1], PC2 = pca_values[, 2],CellLine = rownames(pca_values) )

bone.cancer.celllines.group<- "red"
kidney.cancer.celllines.group <- "blue"
liver.cancer.celllines.group <- "green"
gastric.cancer.celllines.group<- "purple"
breast.cancer.celllines.group <- "orange"

pca_data$Group <- NA
pca_data$Group[pca_data$CellLine %in% bone.cancer.celllines.v] <- "Bone cancer"
pca_data$Group[pca_data$CellLine %in% kidney.cancer.celllines.v] <- "Kidney cancer"
pca_data$Group[pca_data$CellLine %in% liver.cancer.celllines.v] <- "Liver cancer"
pca_data$Group[pca_data$CellLine %in% gastric.cancer.celllines.v] <- "Gastric cancer"
pca_data$Group[pca_data$CellLine %in% breast.cancer.celllines.v]<-"Breast cancer"

ggplot(pca_data, aes(x = PC1, y = PC2, color = Group)) +
  geom_point() +
  scale_color_manual(values = c("Bone cancer"=bone.cancer.celllines.group, "Kidney cancer"=kidney.cancer.celllines.group, "Liver cancer"=liver.cancer.celllines.group, "Gastric cancer"=gastric.cancer.celllines.group,"Breast cancer"= breast.cancer.celllines.group)) +
  labs(x = "PC1", y = "PC2", title = "PCA Scatter Plot")
```
